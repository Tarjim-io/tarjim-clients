## Setup

### Cake 

1. clone tarjim_clients int vendors 
```
git submodule add git@bitbucket.org:joylab/tarjim_clients.git 
```
2. add symlink in vendors/shells to tarjim_clients/cake/tarjim.php in vendors/shells run 
```
ln -s ../tarjim_clients/cake/tarjim.php
```
3. add symlink to tarjim_controller in controllers in controllers run 
```
ln -s ../vendors/tarjim_clients/cake/tarjim_controller.php
```
4. update require once for tarjim-client in config/core to be 
```
require_once _DIR_.'/../vendors/tarjim_clients/cake/tarjim-client.php';
```
5. check cake/README for more instructions

### React
1. clone into src/services 
```
git submodule add git@bitbucket.org:joylab/tarjim_clients.git 
```
2. delete src/services/LocalizationService if it exists
3. add symlink in root project dir for update_locale.php run 
```
ln  -s src/services/tarjim_clients/react/update_locale.php
```
4. update import statements for LocalizationService
```
find ./src -type f -exec sed -i 's/services\/LocalizationService/services\/tarjim_clients\/react/g' {} \;
```
5. check react/README for more instructions




## Update notes
### Cake
1. clear contents of tmp/cache/locale/locale_last_updated
2. copy cake/tarjim-client.php to vendors/tarjim-client.php
3. delete tarjim_v1_controller.php
4. copy cake/tarjim_controller.php to controllers/
5. edit tarjim routes remove 'api/vi' from controller
6. in app_controller->beforeFilter() replace tarjim related code with 

```
// Skip get translations from tarjim for api calls
if (!isset($_GET['skip_get_translations']) || '1' != $_GET['skip_get_translations']) {
## Set active language view variable
	$active_language = $this->Session->read('Config.language');
	$this->set('active_language', $active_language);
	$this->setTranslation(Configure::read('TARJIM_DEFAULT_NAMESPACE'), $active_language);
}

```

### React
1. add to the url params for all api calls skip_get_translations=1
